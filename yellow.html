<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Yellow World</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#E8A000;
  font-family:Arial,sans-serif;
  overflow:hidden;
}

/* ---------- USER BAR ---------- */
#user-bar{
  position:fixed;
  top:20px;
  left:20px;
  display:none;
  align-items:center;
  gap:10px;
  z-index:20;
}

#user-avatar{
  width:36px;
  height:36px;
  border-radius:50%;
}

#status-dot{
  position:absolute;
  bottom:0;
  right:0;
  width:8px;
  height:8px;
  background:#00c853;
  border-radius:50%;
  border:2px solid #E8A000;
}

/* ---------- MAIN ---------- */
.container{
  text-align:center;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}

.play-btn{
  width:80px;height:80px;border-radius:50%;
  border:3px solid #8B5A00;
  background:transparent;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:.5s;
  z-index:2;
}

.play-btn.hidden{opacity:0;pointer-events:none;transform:scale(.8)}
.play-btn svg{width:30px;height:30px;fill:#8B5A00;margin-left:5px}

.text-container{
  position:absolute;
  display:flex;
  flex-direction:column;
  align-items:center;
  opacity:0;
  transition:.5s;
  pointer-events:none;
}

.text-container.visible{
  opacity:1;
  pointer-events:auto;
}

.welcome-text{
  font-family:'Bebas Neue',sans-serif;
  font-size:72px;
  letter-spacing:12px;
  color:#8B5A00;
  margin-bottom:20px;
}

.enter-text{
  font-family:'Bebas Neue',sans-serif;
  font-size:32px;
  letter-spacing:4px;
  color:#8B5A00;
  margin-bottom:30px;
}

.small-text{
  font-size:14px;
  color:#8B5A00;
  opacity:.7;
  font-style:italic;
}

.cursor{
  display:inline-block;
  width:3px;
  height:1em;
  background:#8B5A00;
  margin-left:2px;
  animation:blink .7s infinite;
}

@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}

.x-connect{
  margin-top:50px;
  display:flex;
  flex-direction:column;
  align-items:center;
  opacity:0;
  transform:translateY(20px);
  transition:.8s;
  pointer-events:none;
}

.x-connect.visible{opacity:1;transform:translateY(0);pointer-events:auto}

.x-btn{
  width:60px;height:60px;
  border-radius:50%;
  border:2px solid #8B5A00;
  background:transparent;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
}

.x-btn svg{width:28px;height:28px;fill:#8B5A00}

/* ---------- BADGES ---------- */
#badges-section{
  display:none;
  margin-top:40px;
  text-align:center;
}

.badges-title{
  font-size:14px;
  letter-spacing:1px;
  color:#8B5A00;
}

.badges-sub{
  font-size:12px;
  color:#8B5A00;
  opacity:.7;
  margin-bottom:20px;
}

#badges-grid{
  display:flex;
  justify-content:center;
  gap:14px;
  flex-wrap:wrap;
}

.badge{
  width:46px;height:46px;
  border-radius:50%;
  background:#777;
  opacity:.4;
  cursor:pointer;
  transition:.3s;
}

.badge.unlocked{
  background:#FFD000;
  opacity:1;
}

#badge-info{
  margin-top:10px;
  display:none;
}

#badge-name{
  font-weight:bold;
  color:#8B5A00;
}

#badge-description{
  font-size:12px;
  color:#8B5A00;
  opacity:.7;
}
</style>
</head>

<body>

<div id="user-bar">
  <div style="position:relative">
    <img id="user-avatar">
    <span id="status-dot"></span>
  </div>
</div>

<div class="container">
  <button class="play-btn" id="playBtn">
    <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
  </button>

  <div class="text-container" id="textContainer">
    <div class="welcome-text" id="welcomeText"></div>
    <div class="enter-text" id="enterText"></div>
    <div class="small-text" id="smallText"></div>

    <div class="x-connect" id="xConnect">
      <button class="x-btn" id="xBtn">
        <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231z"/></svg>
      </button>
      <span class="connect-text">Connect with X</span>
    </div>

    <section id="badges-section">
      <p class="badges-title">Badges to collect in the Yellow World</p>
      <p class="badges-sub">Some are obvious.<br>Some are hidden.<br>Some are not for everyone.</p>

      <div id="badges-grid"></div>

      <div id="badge-info">
        <p id="badge-name"></p>
        <p id="badge-description"></p>
      </div>
    </section>
  </div>
</div>

<script>
const playBtn=document.getElementById('playBtn');
const textContainer=document.getElementById('textContainer');
const welcomeText=document.getElementById('welcomeText');
const enterText=document.getElementById('enterText');
const smallText=document.getElementById('smallText');
const xConnect=document.getElementById('xConnect');

function typeWriter(el,text,speed){
  return new Promise(r=>{
    let i=0;
    function t(){
      if(i<text.length){
        el.innerHTML=text.slice(0,i+1)+'<span class="cursor"></span>';
        i++;setTimeout(t,speed);
      }else{el.innerHTML=text;r()}
    }
    t();
  });
}

playBtn.onclick=async()=>{
  playBtn.classList.add('hidden');
  textContainer.classList.add('visible');
  await typeWriter(welcomeText,'WELCOME',120);
  await typeWriter(enterText,'Enter the Yellow World',60);
  await typeWriter(smallText,'Not everyone needs to go further.',40);
  xConnect.classList.add('visible');
};

document.getElementById('xBtn').onclick=()=>location.href='/api/auth/x/login';

/* ---------- STATUS + BADGES ---------- */
fetch('/api/user/status')
.then(r=>r.json())
.then(d=>{
  if(!d.authenticated)return;

  document.getElementById('user-bar').style.display='flex';
  document.getElementById('user-avatar').src=d.user.avatarUrl;
  document.getElementById('badges-section').style.display='block';

  const grid=document.getElementById('badges-grid');
  const info=document.getElementById('badge-info');
  const name=document.getElementById('badge-name');
  const desc=document.getElementById('badge-description');

  const defs=[
    {id:'og',name:'OG',desc:'Early access â€“ first 24 hours'},
    {id:'badge_2'},{id:'badge_3'},{id:'badge_4'},{id:'badge_5'},
    {id:'badge_6'},{id:'badge_7'},{id:'badge_8'},{id:'badge_9'},{id:'badge_10'}
  ];

  defs.forEach(b=>{
    const unlocked=d.badges.find(x=>x.id===b.id)?.unlocked;
    const el=document.createElement('div');
    el.className='badge'+(unlocked?' unlocked':'');
    el.onclick=()=>{
      info.style.display='block';
      if(unlocked && b.id==='og'){
        name.textContent=b.name;
        desc.textContent=b.desc;
      }else{
        name.textContent='???';
        desc.textContent='This badge has not been unlocked yet';
      }
    };
    grid.appendChild(el);
  });
});
</script>
</body>
</html>
